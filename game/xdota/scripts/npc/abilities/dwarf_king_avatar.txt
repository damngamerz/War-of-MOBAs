"dwarf_king_avatar"
{
    "BaseClass"                     "ability_datadriven"
    "AbilityTextureName"            "dwarf_king_avatar"
    "AbilityType"                   "DOTA_ABILITY_TYPE_ULTIMATE"
    "AbilityBehavior"               "DOTA_ABILITY_BEHAVIOR_IMMEDIATE | DOTA_ABILITY_BEHAVIOR_NO_TARGET"
    "AbilityCooldown"               "100"
    "AbilityManaCost"               "100"

    "AbilitySpecial"
    {
        "01"
        {
            "var_type"              "FIELD_INTEGER"
            "duration"              "20 25 25"
        }
        "02"
        {
            "var_type"              "FIELD_INTEGER"
            "health_bonus"         	"800 1200 1600" 
        }
        "03"
        {
        	"var_type"				"FIELD_FLOAT"
        	"bash_duration"			"0.5"
        }
        "04"
        {
        	"var_type"				"FIELD_INTEGER"
        	"bash_chance"			"100"
        }
        "05"
        {
        	"var_type"				"FIELD_INTEGER"
        	"armor_bonus"			"10 15 20"
        }
        "06"
        {
        	"var_type"				"FIELD_INTEGER"
        	"bonus_damage"			"25 50 75"
        }
        "07"
        {
            "var_type"              "FIELD_INTEGER"
            "model_size"            "30"
        }
        "08"
        {
        	"var_type"				"FIELD_FLOAT"
        	"disable_post_red_pct"	"0.25"
        }
    }

    "precache"
    {
        "particle"              "particles/units/heroes/hero_alchemist/alchemist_chemical_rage.vpcf"
        "particle"              "particles/items_fx/black_king_bar_avatar.vpcf"
        "particle"              "particles/status_fx/status_effect_chemical_rage.vpcf"
        "particle"  			"particles/units/heroes/hero_medusa/status_effect_medusa_stone_gaze_backup.vpcf"
    }

    "OnSpellStart"
    {
        "ApplyModifier"
        {
            "Target"        "CASTER"
            "ModifierName"  "modifier_avatar"
            "Duration"      "%duration"
        }

        "ApplyModifier"
        {
        	"ModifierName"	"modifier_fake_basher"
        	"Target" 		"CASTER"
        	"Duration"		"%duration"
        }

        "FireSound"
        {
            "Target"        "CASTER"
            "EffectName"    "DOTA_Item.BlackKingBar.Activate"
        }
    }
    
    "Modifiers"
    {
        "modifier_avatar"
        {	
            "OnCreated"
            {
                "AttachEffect"
                {
                    "Target"            "CASTER"
                    "EffectName"        "particles/test_particle/dwarf_king_avatar_ambient.vpcf"
                    "EffectAttachType"  "follow_origin"
                }

                "RunScript"
                {
                    "ScriptFile"    "heroes/dwarf_king/avatar.lua"
                    "Function"      "Avatar"
                }

                "ApplyModifier"
                {
                	"ModifierName"	"modifier_fake_basher"
                	"Target" 		"CASTER"
                	"Duration"		"%duration"
                }
            }

            "EffectName"            "particles/units/heroes/hero_alchemist/alchemist_chemical_rage.vpcf"
            "EffectAttachType"      "follow_origin"

            "StatusEffectName"      "particles/econ/items/effigies/status_fx_effigies/status_effect_effigy_gold_lvl2.vpcf"
            "StatusEffectPriority"  "5"

            "Properties"
            {
                "MODIFIER_PROPERTY_PHYSICAL_ARMOR_BONUS"    "%armor_bonus"
                "MODIFIER_PROPERTY_BASEATTACK_BONUSDAMAGE"  "%bonus_damage"
                "MODIFIER_PROPERTY_HEALTH_BONUS"            "%health_bonus"
            }

            "States"
            {
                "MODIFIER_STATE_MAGIC_IMMUNE"   "MODIFIER_STATE_VALUE_ENABLED"
            }
        }

        "modifier_fake_basher"
        {
        	"OnAttackLanded"
        	{
        		"RunScript"
				{
					"ScriptFile"	"heroes/generics/Disables.lua"
					"Function"		"ApplyStun"
					"Target" 	 	"TARGET"
					"duration"	 	"%bash_duration"
					"bypass"		"false"
				}
        	}
        }
    }
}
